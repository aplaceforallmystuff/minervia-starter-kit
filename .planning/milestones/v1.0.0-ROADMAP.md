# Milestone v1.0.0: Minervia Installer MVP

**Status:** ✅ SHIPPED 2026-01-19
**Phases:** 1-8
**Total Plans:** 16

## Overview

This roadmap transformed the existing Minervia starter kit into a complete end-to-end installer. The journey progressed from foundational error handling and CLI conventions through the core value proposition (questionnaire-driven CLAUDE.md generation), vault scaffolding, skills installation, and finally a self-update mechanism. Each phase delivered a coherent, testable capability that builds toward the goal: after running the installer, Claude understands your vault and you're immediately productive.

## Phases

### Phase 1: Foundation

**Goal:** Installer has reliable error handling and platform detection that prevents silent failures
**Depends on:** Nothing (first phase)
**Requirements:** CORE-03, CORE-07
**Plans:** 1 plan

Plans:
- [x] 01-01: Strict mode, trap handlers, platform detection, error handling infrastructure

**Details:**
- Script uses `set -euo pipefail` for fail-fast behavior
- Trap handler ensures cleanup runs on both success and error exits
- Platform detected via `uname -s` at startup
- Portable wrappers for BSD vs GNU differences (sed, stat)
- All error messages include actionable recovery steps

### Phase 2: CLI Interface

**Goal:** Installer follows CLI conventions and validates environment before proceeding
**Depends on:** Phase 1
**Requirements:** CORE-01, CORE-04, CORE-09, CORE-10
**Plans:** 2 plans

Plans:
- [x] 02-01: Add VERSION constant, --help and --version flags with argument parsing
- [x] 02-02: Refactor prerequisite checks (Bash version, Claude CLI, write permissions)

**Details:**
- VERSION constant as single source of truth (1.0.0)
- Complete help text with usage, options, examples, prerequisites, uninstall
- Argument parsing runs before any output or checks
- Checks for Claude Code CLI with download link on failure
- Checks Bash 4.0+ requirement with upgrade instructions

### Phase 3: Questionnaire Engine

**Goal:** Installer captures user context through interactive prompts
**Depends on:** Phase 2
**Requirements:** ONBD-01, ONBD-02
**Plans:** 2 plans

Plans:
- [x] 03-01: Gum detection, ANSWERS array, dual-mode input functions, CLI flags
- [x] 03-02: Questionnaire flow, progress indicator, summary/edit, main integration

**Details:**
- 5-question questionnaire (name, vault path, role, areas, preferences)
- Gum-enhanced UI when available, fallback to read -p
- Progress indicator showing "Question X of 5"
- Summary display with edit capability
- Non-interactive mode via CLI flags for automation

### Phase 4: CLAUDE.md Generation

**Goal:** Installer generates personalized CLAUDE.md from questionnaire answers
**Depends on:** Phase 3
**Requirements:** ONBD-03, ONBD-04, ONBD-05
**Plans:** 2 plans

Plans:
- [x] 04-01: Template file with placeholders, vault detection, template processing functions
- [x] 04-02: Diff display, existing file handling, replace heredoc with template generation

**Details:**
- External template file with {{PLACEHOLDER}} syntax
- Vault detection distinguishes new vs existing vaults
- Colored unified diff display for macOS compatibility
- Three-option conflict menu: Keep/Backup+replace/Replace
- Template processing substitutes all user answers

### Phase 5: Vault Scaffolding

**Goal:** New vaults have complete PARA structure with templates and examples
**Depends on:** Phase 4
**Requirements:** VAULT-01, VAULT-02, VAULT-03, VAULT-04
**Plans:** 2 plans

Plans:
- [x] 05-01: PARA folder creation and Obsidian template files
- [x] 05-02: Example notes and scaffold_new_vault integration

**Details:**
- 7 PARA folders (00 Daily/YYYY, 01 Inbox, 02 Projects, 03 Areas, 04 Resources, 04 Resources/Templates, 05 Archive)
- Templates use Obsidian core syntax ({{date:YYYY-MM-DD}}, {{title}})
- Example notes demonstrate wiki linking between PARA sections
- Existing vaults skip scaffolding entirely

### Phase 6: Skills Installation

**Goal:** Skills and agents are installed globally with version tracking
**Depends on:** Phase 5
**Requirements:** SKIL-01, SKIL-02, SKIL-03, SKIL-04
**Plans:** 2 plans

Plans:
- [x] 06-01: State tracking functions, inbox-process skill, pkm-assistant agent
- [x] 06-02: Refactor installation with conflict handling and state tracking

**Details:**
- Skills copied to ~/.claude/skills/
- Agents copied to ~/.claude/agents/
- state.json created in ~/.minervia/ with version and file manifest
- MD5 checksums enable update tracking
- Conflict resolution with keep/backup+replace/replace options

### Phase 7: Idempotency and Safety

**Goal:** Installer is safe to re-run and never destroys user content without confirmation
**Depends on:** Phase 6
**Requirements:** CORE-02, CORE-05, CORE-06, CORE-08
**Plans:** 2 plans

Plans:
- [x] 07-01: Step tracking infrastructure, state validation, lock file protection
- [x] 07-02: Progress feedback, verbose mode, saved answers, final summary

**Details:**
- run_step() wrapper tracks completed steps in state.json
- Lock file prevents concurrent installer runs
- Corrupted state file detection and recovery
- Verbose mode (-v/--verbose) for detailed output
- [OK]/[SKIP]/[FAIL] color-coded status indicators
- Saved answers persistence with Use/Edit/Fresh menu on re-run

### Phase 8: Update System

**Goal:** Users can update Minervia while preserving their customizations
**Depends on:** Phase 7
**Requirements:** UPDT-01, UPDT-02, UPDT-03, UPDT-04, UPDT-05, UPDT-06
**Plans:** 3 plans

Plans:
- [x] 08-01: Update script core: git fetch, version comparison, backup creation, dry-run
- [x] 08-02: Conflict handling: customization detection, merge strategies, changelog, restore
- [x] 08-03: Skills and integration: /minervia:update, /minervia:restore, install.sh wiring

**Details:**
- minervia-update.sh with `git clone --depth 1` for fetching latest
- Checksum comparison detects customized files
- Three merge strategies: Keep mine, Take theirs, Backup + overwrite
- Timestamped backups before any modifications
- Change reporting after completion
- /minervia:update and /minervia:restore skills for Claude Code
- Update script installed to ~/.minervia/bin/

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| Skills to ~/.claude/, not vault | Global installation simplifies updates | ✓ Good |
| State tracking in ~/.minervia/ | Enables idempotent re-runs | ✓ Good |
| Template-based CLAUDE.md | Easier to maintain than heredoc | ✓ Good |
| Gum with fallback | Enhanced UX when available | ✓ Good |
| Checksum-based customization detection | Preserves user work on updates | ✓ Good |

**Issues Resolved:**

- Cross-platform compatibility (macOS/Linux) via portable wrappers
- Colored diff display without GNU diff --color flag
- Concurrent run protection via lock file
- Corrupted state file recovery

**Issues Deferred (v1.1 Candidates):**

- Guided first session (ONBD-06)
- MCP server recommendations (ONBD-08)
- Dry-run mode (DEVX-01)
- Summary/review step (ONBD-07)

**Technical Debt Incurred:**

None — all planned features implemented fully.

---

*For current project status, see .planning/PROJECT.md*
*Archived: 2026-01-19 as part of v1.0.0 milestone completion*
