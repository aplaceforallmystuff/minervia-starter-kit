---
phase: 06-skills-installation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [install.sh, skills/inbox-process/SKILL.md, agents/pkm-assistant/AGENT.md]
autonomous: true

must_haves:
  truths:
    - "installer creates ~/.minervia/ directory if it doesn't exist"
    - "installer writes state.json with version, installed_at timestamp, and files array"
    - "state.json files array contains path and md5 checksum for each installed file"
    - "inbox-process skill exists and is installable"
    - "pkm-assistant agent exists and is installable"
  artifacts:
    - path: "install.sh"
      provides: "compute_md5(), init_state_file(), record_installed_file() functions"
      contains: "compute_md5"
    - path: "skills/inbox-process/SKILL.md"
      provides: "Inbox processing skill for PKM"
      min_lines: 30
    - path: "agents/pkm-assistant/AGENT.md"
      provides: "PKM assistant agent"
      min_lines: 20
  key_links:
    - from: "install.sh"
      to: "~/.minervia/state.json"
      via: "init_state_file and record_installed_file"
      pattern: "state\\.json"
---

<objective>
Create state tracking infrastructure and new PKM content (skill + agent).

Purpose: Enable version tracking and checksum-based update detection for Phase 8. Add inbox-process skill and pkm-assistant agent as new installable content.

Output: State management functions in install.sh, inbox-process skill, pkm-assistant agent.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-skills-installation/06-CONTEXT.md

@install.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add state tracking functions to install.sh</name>
  <files>install.sh</files>
  <action>
Add three functions to install.sh in a new "State Tracking" section (after Platform Detection, before Gum Detection):

1. `compute_md5()` - Cross-platform MD5 computation:
   - Takes file path as argument
   - On macOS: uses `md5 -q "$file"`
   - On Linux: uses `md5sum "$file" | cut -d' ' -f1`
   - Returns just the 32-char hash (no filename)

2. `init_state_file()` - Initialize ~/.minervia/state.json:
   - Creates ~/.minervia/ directory if needed (mkdir -p)
   - If state.json doesn't exist, create with initial structure:
     ```json
     {
       "version": "$VERSION",
       "installed_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
       "files": []
     }
     ```
   - Use heredoc or printf for JSON creation
   - If state.json exists, update version and leave files array intact

3. `record_installed_file()` - Add file to manifest:
   - Takes two args: relative_path (e.g., "skills/log-to-daily/SKILL.md"), absolute_path
   - Computes MD5 of the file using compute_md5()
   - Appends to files array in state.json
   - JSON manipulation: Use a temp file approach - read JSON, use awk/sed to insert entry before closing `]`
   - Entry format: `{"path": "...", "md5": "..."}`

Note: Keep JSON manipulation simple. Use printf and file operations rather than jq (not a dependency).
  </action>
  <verify>
Bash syntax check: `bash -n install.sh`
Visual inspection: functions exist in State Tracking section
  </verify>
  <done>
install.sh contains compute_md5, init_state_file, record_installed_file functions with cross-platform MD5 support
  </done>
</task>

<task type="auto">
  <name>Task 2: Create inbox-process skill</name>
  <files>skills/inbox-process/SKILL.md</files>
  <action>
Create `skills/inbox-process/SKILL.md` - a skill for processing inbox items during reviews.

Structure following existing skill patterns (reference skills/weekly-review/SKILL.md):
- Frontmatter with skill name, description, trigger
- Clear purpose explaining Inbox processing
- Workflow steps:
  1. List items in 01 Inbox/
  2. For each item, suggest: Move to Projects, Move to Areas, Move to Resources, Archive, Delete
  3. Ask user for decision
  4. Execute move/delete
  5. Summary of processed items

Keep it focused - this is inbox triage, not full weekly review.
Trigger: /inbox-process
  </action>
  <verify>
File exists: `ls skills/inbox-process/SKILL.md`
Structure check: Has frontmatter, purpose, workflow sections
  </verify>
  <done>
skills/inbox-process/SKILL.md exists with inbox processing workflow
  </done>
</task>

<task type="auto">
  <name>Task 3: Create agents directory and pkm-assistant agent</name>
  <files>agents/pkm-assistant/AGENT.md</files>
  <action>
Create `agents/pkm-assistant/AGENT.md` - a PKM-focused Claude agent.

Agent format (different from skills - agents define Claude's persona/expertise):
```markdown
---
agent: pkm-assistant
description: Personal knowledge management assistant
---

# PKM Assistant

You are a personal knowledge management assistant specializing in the PARA methodology...

## Expertise
- PARA folder organization
- Daily note workflows
- Weekly review processes
- Connecting ideas across the vault

## Behaviors
- Always suggest appropriate PARA locations for new content
- Reference existing notes when relevant
- Help maintain inbox zero
- Encourage atomic, linked notes
```

Keep it concise - agents set context, they don't define procedures (that's what skills do).
  </action>
  <verify>
Directory exists: `ls -la agents/`
File exists: `ls agents/pkm-assistant/AGENT.md`
Has frontmatter with agent name
  </verify>
  <done>
agents/pkm-assistant/AGENT.md exists with PKM expertise definition
  </done>
</task>

</tasks>

<verification>
1. Bash syntax: `bash -n install.sh` - no errors
2. State functions: `grep -c "compute_md5\|init_state_file\|record_installed_file" install.sh` returns 3+
3. Inbox skill: `test -f skills/inbox-process/SKILL.md && echo "exists"`
4. Agent: `test -f agents/pkm-assistant/AGENT.md && echo "exists"`
</verification>

<success_criteria>
- install.sh has state tracking functions with cross-platform MD5
- inbox-process skill exists with triage workflow
- pkm-assistant agent exists in agents/ directory
- All files pass syntax/structure validation
</success_criteria>

<output>
After completion, create `.planning/phases/06-skills-installation/06-01-SUMMARY.md`
</output>
